# Vaccination Policies study using the XPRIZE Pandemic Response Challenge lstm model

Using the "Valencia XPRIZE Pandemic Response Challenge" models and repository (https://github.com/malozano/valencia-ia4covid-xprize), I made a study of viability using the vaccination polices recently added (on July 2021) to de latest data sets by the Oxford COVID-19 government response tracker.

All information about the training of the models which will be compared (model npi-lstm, lstm plus vp summary variables, lstm plus vp variables), can be found on the "LSTM-VP-Covid_xprice/covid_xprize/examples/predictors/lstm/Custom-LSTM-Predictor.ipynb" notebook.

On the other hand, the study of predictions and conclusions are explained and placed on the "LSTM-VP-Covid_xprice/lstm_plus_vp_predictor_robojudge.ipynb" notebook.

The final conclusions learned from this study, which will be explained in detail in the files mentioned on the previous paragraph, were that including the V1, V2 and V3 vaccination variables, significantly improves the accuracy of the predictions, versus the old npi based models. 

## Introduction

In addition to the valencia xprice pandemic response challenge repository models, python files, data sets on csv files and notebooks. I added the next files for the study:
* 2 New lstm models, in the form of Jupyter notebooks and python scripts
* 2 New implementations implementations of the "predict" API
* New IP (Intervention Plan) data, including all variables as V1, V2 and V3. 

## Pre-requisites
To run the examples, you will need:
* A computer or cloud image running a recent version of OS X or Ubuntu (Using Microsoft Windows™ may be possible but
the XPRIZE team and Cognizant will be unable to support you.) 
* Your machine must have sufficient resources in terms of memory, CPU, and disk space to train machine learning models 
and run Python programs.
* An installed version of Python, version ≥ 3.6. To avoid dependency issues, we strongly recommend using a standard Python [virtual environment](https://docs.python.org/3/tutorial/venv.html) with `pip` for package management. The examples in this repo assume you are using such an environment.

Having registered for the contest, you should also have:
* A copy of the Competition Guidelines
* Access to the Support Slack channel
* A pre-initialized sandbox within the XPRIZE system

## Examples
Under the `covid_xprize/examples` directory you will find some examples of predictors and prescriptors that you can 
inspect to learn more about what you need to do:
* `predictors/linear` contains a simple linear model, using the 
[Lasso algorithm](https://en.wikipedia.org/wiki/Lasso_(statistics)).
* `predictors/lstm` contains a more sophisticated [LSTM](https://en.wikipedia.org/wiki/Long_short-term_memory) 
model for making predictions.
* `prescriptors/zero` contains a trivial prescriptor that always prescribes no interventions; 
`prescriptors/random` contains one that prescribes random interventions.
* `prescriptors/neat` contains code for training prescriptors with [NEAT](https://en.wikipedia.org/wiki/Neuroevolution_of_augmenting_topologies)
 
The instructions below assume that you are using a standard Python virtual environment, and `pip` for package 
management. Installations using other environments (such as `conda`) are outside the scope of these steps.

In order to run the examples locally:
1. Ensure your current working directory is the root folder of this repository (the same directory as this README 
resides in). The examples assume your working directory is set to the project root and all paths are relative to 
it.
1. Ensure your `PYTHONPATH` includes your current directory:
    ```shell script
    export PYTHONPATH="$(pwd):$PYTHONPATH"
    ```
1. Create a Python [virtual environment](https://docs.python.org/3/tutorial/venv.html)
1. Activate the virtual environment
1. Install the necessary requirements:
    ```shell script
    pip install -r requirements.txt --upgrade
    ```    
1. Start Jupyter services:
    ```shell script
    jupyter notebook
    ```
    This causes a browser window to launch
1.  Browse to and launch one of the examples (such as `linear`) and run through the steps in the associated 
notebook -- in the case of `linear`, `Example-Train-Linear-Rollout-Model.ipynb`.
1. The result should be a trained predictor, and some predictions generated by running the predictor on test data. 
Details are in the notebooks.

#### Trained standard predictor

The repo also provides a trained standard predictor to train prescriptors against.
To use it, call `covid_xprize/standard_predictor/predict.py` to make predictions.
See `get_predictions` in `covid_xprize/examples/prescriptors/neat/utils.py` and
`generate_cases_and_stringency_for_prescriptions` in `prescriptor_robojudge.ipynb`
for examples of how to make this call.

For more background information please see also the research paper 
[From Prediction to Prescription: Evolutionary Optimization of Non-Pharmaceutical Interventions in the COVID-19 Pandemic](http://nn.cs.utexas.edu/?miikkulainen:ieeetec21). 

Copyright 2020 (c) Cognizant Digital Business, Evolutionary AI. All rights reserved. Issued under the Apache 2.0 License.
>>>>>>> ab32281 (custom-lstm-notebook-testing for testing purposes; custom-lstm-notebook for training lstm, lstm+vpsummary and lstm+vp models; predictV2.py, predictV3.py, xprizeV2.py, xprizeV3.py files for custom-lstm predictores models)
